== Package Dependency Graph

The Package Dependency graph has been added to the *Investigate* page within the xref:[Application Asset Query] capabilities. This graphical representation of your xref:sbom.adoc[SBOM] allows you to explore package dependencies from code repositories using the ../../../search-and-investigate/application-asset-queries/application-asset-queries.adoc[Simple Mode Query] builder. You can investigate both transitive and intransitive packages, including their licenses and vulnerabilities. 

//For transitive packages, you can view their dependency tree by clicking on the 'indirect' connection edge.

*Requirement*:  You must enable the CAS SCA module. For more information, refer to licenses are available as a part of the xref:../../../administration/prisma-cloud-licenses.adoc[Prisma Cloud License Types].

//Other use cases of the Supply Chain graph, like Image Referencer and IaC Resources Exploration, are not yet integrated into the Application Asset Graph.

[.task]
=== Query Example

Find all code repositories that import packages infected with the *CVE-2017-20165* vulnerability through package files.  

[.procedure]

. Select *Investigate* on the Prisma Cloud console.

. Select *Application Asset* from the *Select a Query Type* field.
. Under *Type*, select *VCS repository*, which represents a repository.
. Add clauses: 
.. Click *+ Add* > select *that contains PackageFile**.
.. Click *+ Add* > *That Depends On Package*.
.. Click *+ Add* > *That Has Vulnerability*
.. Click *+ Add* > *id* > *is* > select a CVE value from the list.
+
NOTE: In this example, CVE-2017-20165 is*  selected.
+
The query results are displayed.
+
image::application-security/sbom-dep-graph-query1.1.png[]

=== Legend

* Numbers next to VCS Repository: represents the grouping and amount or repositories containing the package file

* Numbers next to PackageFile: represents the grouping and amount of package files depending on the package

* Numbers next to Package: represents the grouping and amount of packages including the CVE vulnerability

* The edges describe the relationships between the nodes

* Clicking on a number expands the entity, allowing you to drill-down, and to click on each child entity for additional details

* Clicking on the vulnerability displays its details, such as severity, CVSS score, impacted stages and more

image::application-security/sbom-dep-graph-expnd1.1.png[]  

NOTE: A link icon on the edge denotes indirect dependencies. Click on the icon to view details of the indirect dependency between a package file and its package. 

image::application-security/sbom-dep-graph-indirect1.1.png[]